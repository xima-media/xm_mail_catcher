define("TYPO3/CMS/XmMailCatcher/MailCatcher",["TYPO3/CMS/Backend/Modal","TYPO3/CMS/Backend/Severity","TYPO3/CMS/Core/Ajax/AjaxRequest","jquery"],((e,t,s,a)=>{return n={735:(e,t,s)=>{var a,n;a=[s,t,s(404),s(901),s(580),s(339)],n=function(e,t,s,a,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmMailCatcher=void 0,t.XmMailCatcher=new class{constructor(){this.bindListener()}bindListener(){s(".content-type-switches a").on("click",this.onContentTypeSwitchClick.bind(this)),s("button[data-delete]").on("click",this.onDeleteButtonClick.bind(this)),s("#delete-all-messages").on("click",this.onDeleteAllMessagesClick.bind(this))}onDeleteAllMessagesClick(e){e.preventDefault();const t=this;n.confirm("Delete Messages","Are you sure, you want to delete all messages?",r.warning,[{text:"Yes, delete",btnClass:"btn-danger",trigger:function(){t.deleteAllMessages(),n.dismiss()}},{text:"No, abort",btnClass:"primary-outline",active:!0,trigger:function(){n.dismiss()}}])}deleteAllMessages(){const e=this,t=s(".panel[data-message-file]");new a(TYPO3.settings.ajaxUrls.mailcatcher_delete_all).get().then((async function(s){if((await s.resolve()).success)return t.remove(),e.refreshMessageCount(),void top.TYPO3.Notification.success("Success","All messages have been deleted",3);top.TYPO3.Notification.error("Error","Could not delete messages",3)}))}refreshMessageCount(){const e=s(".panel[data-message-file]").length;s("*[data-message-count]").attr("data-message-count",e),s(".message-count").html(e.toString())}onDeleteButtonClick(e){e.preventDefault();const t=s(e.currentTarget).closest(".panel"),n=t.attr("data-message-file"),r=this;new a(TYPO3.settings.ajaxUrls.mailcatcher_delete).withQueryArguments({messageFile:n}).get().then((async function(e){if((await e.resolve()).success)return t.remove(),void r.refreshMessageCount();top.TYPO3.Notification.error("Error","Could not delete message",3)}))}onContentTypeSwitchClick(e){e.preventDefault();const t=s(e.currentTarget).attr("data-content-type"),a=s(e.currentTarget).attr("data-m-id");s('.content-type-switches a[data-m-id="'+a+'"]').addClass("btn-outline-primary").removeClass("btn-primary"),s('.content-type-switches a[data-m-id="'+a+'"][data-content-type="'+t+'"]').removeClass("btn-outline-primary").addClass("btn-primary"),s('.form-section[data-m-id="'+a+'"]').addClass("hidden"),s('.form-section[data-m-id="'+a+'"][data-content-type="'+t+'"]').removeClass("hidden");const n=s(e.currentTarget).closest(".panel");"false"===n.attr("data-html-loaded")&&this.loadHtmlMail(n.attr("data-message-file"))}loadHtmlMail(e){new a(TYPO3.settings.ajaxUrls.mailcatcher_html).withQueryArguments({messageFile:e}).get().then((async function(t){const a=await t.resolve(),n=s("<iframe />").attr("width","100%").attr("height","500px").attr("srcdoc",a.src);s('.panel[data-message-file="'+e+'"] .form-section[data-content-type="html"]').html(n)}))}}}.apply(t,a),void 0===n||(e.exports=n)},580:t=>{"use strict";t.exports=e},339:e=>{"use strict";e.exports=t},901:e=>{"use strict";e.exports=s},404:e=>{"use strict";e.exports=a}},r={},function e(t){var s=r[t];if(void 0!==s)return s.exports;var a=r[t]={exports:{}};return n[t](a,a.exports,e),a.exports}(735);var n,r}));